!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("chalk"),require("update-notifier"),require("log-symbols"),require("inquirer"),require("ora"),require("download-git-repo"),require("handlebars")):"function"==typeof define&&define.amd?define(["chalk","update-notifier","log-symbols","inquirer","ora","download-git-repo","handlebars"],t):"object"==typeof exports?exports.JsartCli=t(require("chalk"),require("update-notifier"),require("log-symbols"),require("inquirer"),require("ora"),require("download-git-repo"),require("handlebars")):e.JsartCli=t(e.chalk,e["update-notifier"],e["log-symbols"],e.inquirer,e.ora,e["download-git-repo"],e.handlebars)}(global,(function(e,t,r,n,o,i,c){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){var n=r(1),o=r(8);e.exports=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r={success:n.greenBright("".concat(o.success," 成功")),fail:n.redBright("".concat(o.error," 失败")),error:n.redBright("".concat(o.error," 错误")),warming:n.yellow("".concat(o.warning," 提示")),version:n.blueBright("版本"),log:n.underline.white("提示")};Object.keys(r).forEach((function(e){var o=r[e];t[e]=function(e){console.log(o,n.white(e))}}))}},function(t,r){t.exports=e},function(e,t,r){var n=r(3),o=r(4).execSync;function i(){return n.resolve(__dirname,"../")}e.exports={getRootPath:i,getPkgPath:function(){return n.join(i(),"package.json")},shouldUseCnpm:function(){try{return o("cnpm --version",{stdio:"ignore"}),!0}catch(e){return!1}}}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("child_process")},function(e,t,r){t.version=r(6),t.JsartInit=r(9),t.JsartBuild=r(16),t.JsartServe=r(17),t.JsartUpdate=r(18)},function(e,t,r){var n=require,o=r(7),i=r(0),c=n((0,r(2).getPkgPath)()),a=o({pkg:c,updateCheckInterval:6e4});i.version("Jsart v".concat(c.version)),a.update&&i.version("Jsart 有可更新版本: ".concat(a.update.latest,"，如需更新请执行 jsart update 命令")),e.exports=c.version},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10),i=r(3),c=r(4).exec,a=r(11),s=r(12),u=r(13),l=r(14),p=r(1),f=r(0),d=r(15),m=r(2).shouldUseCnpm,h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.projectName=t,this.projectDir=process.cwd(),this.init()}var t,r,h;return t=e,(r=[{key:"init",value:function(){var e=this,t=this.promptFillItem(o.existsSync(this.projectName));a.prompt(t).then((function(t){e.projectName=t.projectName||e.projectName,e.projectPath=i.join(e.projectDir,e.projectName),e.answers=t,f.log("Jsart 即将创建一个新项目！"),e.downloadTpl().then((function(){e.initGit().then((function(){e.installPkg().then((function(){f.success("创建项目 ".concat(p.green.bold(e.projectName)," 成功！")),f.success("请进入项目目录 ".concat(p.green.bold(e.projectName)," 开始工作吧!"))}))}))}))}))}},{key:"promptFillItem",value:function(e){var t=[],r=this.projectName;return e&&(f.warming("当前目录已经存在 ".concat(r," 项目，请换一个项目名！")),t.push({type:"input",name:"projectName",message:"请输入项目名称：",validate:function(e){return e?!o.existsSync(e)||"项目名依然重复！":"项目名不能为空！"}})),t.push({type:"input",name:"description",message:"请输入项目介绍："}),t.push({type:"list",name:"css",message:"请选择 CSS 预处理器 (Sass/Less)：",choices:[{name:"Sass",value:"sass"},{name:"Less",value:"less"},{name:"无",value:"none"}]}),t}},{key:"downloadTpl",value:function(){var e=this.projectName,t=this.answers;return new Promise((function(r){if(!d.tplDownload)return r();var n=s("正在下载模板文件...");n.start(),u(d.tplGitUrl,e,{clone:!0},(function(i){if(i)n.fail(),f.error("模板下载失败，请重试！"),f.error(i);else{n.succeed();var c="".concat(e,"/package.json"),a={name:t.projectName||e,description:t.description};if(o.existsSync(c)){var s=o.readFileSync(c).toString(),u=l.compile(s)(a);o.writeFileSync(c,u)}f.success("模板下载成功！"),r()}}))}))}},{key:"initGit",value:function(){var e=this;return new Promise((function(t){if(!d.tplDownload)return t();var r=e.projectName,n=e.projectPath,o=s("cd ".concat(p.cyan.bold(r),", 执行 ").concat(p.cyan.bold("git init"),"...\n"));o.start(),process.chdir(n),c("git init",(function(e,r,n){e?(o.fail(),f.error("Git仓库初始化失败，请自行重新初始化！"),f.error(e)):(o.succeed(),f.success("Git仓库初始化完成！"),f.success("".concat(n).concat(r))),t()}))}))}},{key:"installPkg",value:function(){return new Promise((function(e){if(!d.autoInstallPkg)return e();var t=m()?"cnpm install":"npm install",r=s("执行安装项目依赖 ".concat(p.cyan.bold(t),", 请稍等..."));r.start(),c(t,(function(t,n,o){t?(r.fail(),f.error("安装项目依赖失败，请自行重新安装！"),f.error(t)):(r.succeed(),f.success("依赖安装成功！"),f.success("".concat(o).concat(n))),e()}))}))}}])&&n(t.prototype,r),h&&n(t,h),e}();e.exports=h},function(e,t){e.exports=require("fs")},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){e.exports=i},function(e,t){e.exports=c},function(e,t){e.exports={tplGitUrl:"https://github.com:jsart/jsart-template#master",autoInstallPkg:!1,tplDownload:!0}},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(){}}])}));